import { ReflectiveInjector } from '@angular/core';
import { async, fakeAsync, tick } from '@angular/core/testing';
import { BaseRequestOptions, ConnectionBackend, Http, RequestOptions, Connection } from '@angular/http';
import { Response, ResponseOptions } from '@angular/http';
import { MockBackend, MockConnection } from '@angular/http/testing';

import {CommunityProvider, Community} from './community';

describe('MockBackend Community', () => {
    beforeEach(() => {
        this.injector = ReflectiveInjector.resolveAndCreate([
            {provide: ConnectionBackend, useClass: MockBackend},
            {provide: RequestOptions, useClass: BaseRequestOptions},
            Http,
            CommunityProvider
        ]);

        this.communityProvider = this.injector.get(CommunityProvider);
        this.backend = this.injector.get(Connection) as MockBackend;
        this.backend.connection.subscribe((connection: any) => this.lastConnection = connection);
    });

    // ensure correct endpoint
    it('get_all_communities() should query current service url', () => {
        this.communityProvider.get_all_communities();

        expect(this.lastConnection).toBeDefined('no http service connection');
        expect(this.lastConnection.request.url).toMatch(/api\/community$/, 'url invalid');
    });

    // test returning a couple communities
    it('get_all_communities() should return a list of communities', fakeAsync(() => {
        let result: Community[];

        this.communityProvider.get_all_communities().then((communities: Community[]) => result = communities);

        this.lastConnection.mockRespond(new Response(new ResponseOptions({
            body: JSON.stringify({data: 
                [new Community(1, "Example Community", [[[[-79.391194827, 43.681081124], [-79.391405432, 43.680969554], [-79.393223778, 43.68016564], [-79.395808832, 43.67897994], [-79.39734939, 43.678274813], [-79.397456054, 43.678225407], [-79.397563898, 43.678167002], [-79.397671319, 43.678117597], [-79.397779545, 43.678068202], [-79.397888536, 43.678014289], [-79.397931367, 43.67799496], [-79.397944053, 43.678026295], [-79.398012159, 43.678203874], [-79.398140901, 43.678530736], [-79.39835151, 43.679039165], [-79.398562968, 43.679554271], [-79.398733166, 43.679962231], [-79.39893948, 43.680460422], [-79.399065448, 43.680766541], [-79.399215419, 43.681127631], [-79.399803535, 43.682543482], [-79.400168894, 43.683415978], [-79.400209291, 43.683526704], [-79.400530362, 43.684309799], [-79.400841057, 43.685027249], [-79.40112639, 43.685716067], [-79.401495486, 43.686640698], [-79.402338541, 43.688721201], [-79.403084698, 43.690632725], [-79.403084595, 43.69068726], [-79.40306224, 43.690739752], [-79.403017635, 43.690782127], [-79.401858246, 43.690989071], [-79.401758471, 43.691018509], [-79.401694884, 43.691039868], [-79.401586377, 43.691075806], [-79.401475066, 43.691059555], [-79.400869288, 43.691197554], [-79.401046406, 43.691647493], [-79.401129155, 43.691756401], [-79.401284819, 43.692098259], [-79.401589348, 43.692923003], [-79.401895134, 43.693727159], [-79.402191292, 43.694575291], [-79.402323138, 43.694891641], [-79.402372873, 43.695111837], [-79.402403564, 43.695494538], [-79.403094469, 43.695349317], [-79.403506916, 43.695259526], [-79.404674309, 43.695019966], [-79.405052346, 43.695978147], [-79.405281498, 43.696553361], [-79.405412512, 43.696951675], [-79.405611741, 43.697479664], [-79.405883211, 43.698180489], [-79.405661289, 43.698018991], [-79.405471175, 43.697963262], [-79.404605213, 43.697686571], [-79.403203304, 43.697269527], [-79.40312408, 43.697261791], [-79.402963269, 43.697149125], [-79.402769041, 43.697126386], [-79.402584239, 43.697074482], [-79.402277968, 43.696997568], [-79.401668084, 43.696834151], [-79.401266766, 43.696730327], [-79.400089966, 43.696390928], [-79.398961414, 43.696096816], [-79.398039911, 43.695845162], [-79.397199651, 43.695652603], [-79.396884534, 43.695603138], [-79.396105325, 43.695658887], [-79.395379674, 43.692273296], [-79.395342183, 43.692098523], [-79.395170311, 43.691261324], [-79.39506256, 43.690784199], [-79.394936396, 43.690199042], [-79.394891382, 43.690000974], [-79.394821305, 43.689735385], [-79.394603411, 43.689217051], [-79.394567687, 43.689132066], [-79.394141978, 43.688083036], [-79.393705219, 43.687133004], [-79.393331962, 43.68623254], [-79.393185671, 43.685881365], [-79.392854227, 43.685025923], [-79.392384472, 43.683940867], [-79.392032918, 43.683101241], [-79.391939056, 43.682874946], [-79.391630762, 43.682148949], [-79.391555118, 43.681973354], [-79.391340234, 43.681431807], [-79.391194827, 43.681081124]]]]), 
                new Community(2, "Another Community", [])]}),
        })));

        tick();

        expect(result.length).toEqual(2, ' should return 2 communities');
        expect(result[0].id).toEqual(1, ' id of community 1 should be 1');
        expect(result[0].name).toEqual("Example Community", ' name of community 1 should be Example Community');
        expect(result[1].id).toEqual(1, ' id of community 2 should be 2');
        expect(result[1].name).toEqual("Another Community", ' name of community 2 should be Example Community');
    }));

    // test returning commmunity surrounding user
    it('get_community_surrounding() should return a community', fakeAsync(() => {
        let result: Community;

        this.communityProvider.get_community_surrounding('43.6439,-79.3740').then((community: Community) => result = community);
        this.lastConnection.MockBackend(new Response(new ResponseOptions({
            body: JSON.stringify({data:
                [new Community(77, "Waterfront Communities-The Island", [[[[43.646884793,-79.376974315],[43.647460738,-79.37576351],[43.648194454,-79.374297472],[43.648323179,-79.374040251],[43.648377924,-79.373973767],[43.648443732,-79.373900246],[43.648481629,-79.373867987],[43.648513451,-79.373852971],[43.648565874,-79.373836436],[43.648627761,-79.373863873],[43.648677555,-79.373306875],[43.648826829,-79.372968179],[43.649131046,-79.372193018],[43.649450204,-79.37146499],[43.649791744,-79.370413317],[43.649807702,-79.370356557],[43.649819095,-79.37031555],[43.64982935,-79.370277694],[43.649844162,-79.370219349],[43.650100176,-79.369074034],[43.650394727,-79.367892463],[43.650681237,-79.366692775],[43.650918873,-79.365621168],[43.651273527,-79.36403029],[43.651568564,-79.362740419],[43.651913857,-79.361265598],[43.652024282,-79.361108364],[43.652102421,-79.360997072],[43.652211419,-79.360899977],[43.652269386,-79.360846277],[43.652488745,-79.360706864],[43.65264433,-79.360592516],[43.652723355,-79.360512845],[43.652829975,-79.360365511],[43.652865454,-79.36031169],[43.652886514,-79.360279795],[43.652974811,-79.360145894],[43.653024026,-79.36007129],[43.653489539,-79.359282601],[43.653906094,-79.35853322],[43.654288833,-79.357833158],[43.654481734,-79.357508227],[43.654396917,-79.357375281],[43.654379042,-79.357269463],[43.654380967,-79.357132258],[43.654398721,-79.356976816],[43.654489695,-79.356529084],[43.654510925,-79.35643215],[43.654773566,-79.355232796],[43.654816035,-79.35504237],[43.654910737,-79.354645046],[43.655098467,-79.353857501],[43.655204058,-79.353414498],[43.655331207,-79.352881025],[43.655438649,-79.352438373],[43.655483845,-79.35219515],[43.655504817,-79.352078984],[43.655565674,-79.351741799],[43.654769103,-79.350838752],[43.653729395,-79.349660047],[43.653599436,-79.349523686],[43.653594199,-79.349518194],[43.652531506,-79.34865073],[43.651954712,-79.34817655],[43.651918248,-79.348140825],[43.651747045,-79.347997517],[43.651575847,-79.347858091],[43.651427262,-79.347734825],[43.651422666,-79.347731006],[43.651255994,-79.3476152],[43.651098319,-79.347495505],[43.65098928,-79.347420751],[43.650803809,-79.34732204],[43.650748805,-79.347296937],[43.650513197,-79.347465197],[43.650418925,-79.347654102],[43.647680352,-79.3542669],[43.647647794,-79.354345507],[43.647621919,-79.354405813],[43.645496941,-79.359357869],[43.645298574,-79.359853902],[43.638066886,-79.353684375],[43.633394294,-79.349647804],[43.633712648,-79.352515255],[43.633303748,-79.352037999],[43.632560077,-79.35119671],[43.632542053,-79.351179714],[43.631766812,-79.3502847],[43.631023072,-79.349387278],[43.63098268,-79.349475677],[43.630906252,-79.349533965],[43.630766738,-79.349545539],[43.630595765,-79.349585075],[43.630478999,-79.349611253],[43.630126706,-79.349679269],[43.629898775,-79.349692139],[43.62973791,-79.34971715],[43.629639627,-79.349760469],[43.629456388,-79.349767083],[43.629313375,-79.349779741],[43.629040788,-79.349823492],[43.629049804,-79.349884998],[43.62917495,-79.349884689],[43.629273266,-79.349865993],[43.629429698,-79.349865606],[43.629532452,-79.349834582],[43.629644185,-79.349828146],[43.629680079,-79.349938821],[43.629734057,-79.35020944],[43.629761203,-79.350473977],[43.629815489,-79.350990736],[43.629833873,-79.351396814],[43.629883944,-79.352116631],[43.629889005,-79.352596582],[43.629876438,-79.353267333],[43.629841366,-79.353821238],[43.629806098,-79.354221291],[43.629770581,-79.354412135],[43.629595048,-79.354505396],[43.629575825,-79.354552695],[43.629476877,-79.354605585],[43.629346464,-79.354682195],[43.629202534,-79.354761142],[43.629054103,-79.354828876],[43.628896696,-79.35491755],[43.628748292,-79.355006959],[43.62858638,-79.355090969],[43.628424469,-79.355175773],[43.628258088,-79.355284602],[43.628100697,-79.355384487],[43.627466696,-79.355830896],[43.62731382,-79.355940829],[43.627151963,-79.356067449],[43.627017108,-79.356192446],[43.626868758,-79.3563229],[43.626720434,-79.356466142],[43.626563109,-79.356623716],[43.626410286,-79.356776248],[43.626266478,-79.35694],[43.625449205,-79.357821788],[43.624629563,-79.358929901],[43.624211059,-79.359532067],[43.62392552,-79.359984719],[43.623757669,-79.36018238],[43.62290313,-79.361362667],[43.622397393,-79.362085235],[43.62158926,-79.363320776],[43.620695053,-79.364522311],[43.61992226,-79.365643791],[43.6193381,-79.366453124],[43.619266195,-79.36662259],[43.6191969,-79.366715182],[43.619125369,-79.366810864],[43.619053933,-79.366983587],[43.6190406,-79.367066814],[43.619021384,-79.367139771],
                [43.619046316,-79.367176193],[43.618903512,-79.367586349],[43.618776234,-79.36787936],[43.618736033,-79.36796573],[43.618555141,-79.36836055],[43.618434564,-79.368635058],[43.618336318,-79.368860218],[43.61830725,-79.368891094],[43.618277674,-79.368900933],[43.618230143,-79.36900989],[43.618201144,-79.36909932],[43.618181117,-79.369204131],[43.617991297,-79.369626696],[43.617825893,-79.369855082],[43.61779455,-79.369855149],[43.617769992,-79.369916828],[43.617736621,-79.370104866],[43.617709925,-79.37024976],[43.617598268,-79.370493431],[43.617544606,-79.37056133],[43.617466338,-79.37064162],[43.617394792,-79.370718799],[43.617352297,-79.370758957],[43.617319597,-79.370808189],[43.617259763,-79.370973473],[43.617227977,-79.37103544],[43.617177477,-79.371120677],[43.61714754,-79.371169754],[43.617102644,-79.371229171],[43.617065207,-79.371275687],[43.617005297,-79.371335135],[43.616960381,-79.371384244],[43.616919184,-79.37141787],[43.616877992,-79.371448906],[43.616819938,-79.371485144],[43.616782481,-79.371508429],[43.61673753,-79.371534318],[43.616636356,-79.371552594],[43.616606368,-79.371557812],[43.616535166,-79.371565705],[43.616495811,-79.371565787],[43.616477082,-79.371568403],[43.616469589,-79.371581317],[43.616464007,-79.371620021],[43.616464069,-79.371674189],[43.61645662,-79.371702577],[43.616432265,-79.371720692],[43.616409826,-79.371762009],[43.616338147,-79.371944846],[43.616358964,-79.372037019],[43.616449971,-79.372227742],[43.616467678,-79.37227631],[43.616470265,-79.372335317],[43.616412464,-79.372508992],[43.616352062,-79.372627143],[43.616319357,-79.372696642],[43.616281626,-79.372780029],[43.616221188,-79.372866931],[43.616170902,-79.372998948],[43.616113079,-79.373162215],[43.616070299,-79.373238673],[43.61601491,-79.373332515],[43.615972121,-79.373402022],[43.615939426,-79.373488867],[43.61584636,-79.373714698],[43.615748191,-79.373878046],[43.615700347,-79.373951044],[43.61563241,-79.374093503],[43.615571999,-79.37419776],[43.615470033,-79.374331144],[43.615393196,-79.374468651],[43.615331979,-79.374584877],[43.615293731,-79.374673615],[43.615261607,-79.374741227],[43.61523097,-79.374777183],[43.615201842,-79.374794129],[43.615188086,-79.374825811],[43.615162102,-79.374918748],[43.61513152,-79.374996926],[43.615070291,-79.375102597],[43.614993749,-79.375231515],[43.614927904,-79.375330863],[43.614872772,-79.375398522],[43.614793092,-79.375490625],[43.614708198,-79.375556002],[43.614638371,-79.375652396],[43.614533683,-79.375841656],[43.614496329,-79.37593454],[43.61448141,-79.375996442],[43.614466452,-79.376023977],[43.6144465,-79.376044645],[43.614436549,-79.376082477],[43.614439134,-79.376164959],[43.614456786,-79.37631274],[43.614474365,-79.376402068],[43.614479443,-79.376477682],[43.614467198,-79.376704579],[43.614464885,-79.376869571],[43.614467528,-79.377007062],[43.614472599,-79.3770758],[43.614457646,-79.37709989],[43.614427746,-79.377168698],[43.614410296,-79.377189361],[43.61434554,-79.377364797],[43.614250864,-79.377574661],[43.614118845,-79.377891158],[43.614055147,-79.377963898],[43.613981252,-79.378231092],[43.613934943,-79.378368877],[43.613895769,-79.378486986],[43.6138566,-79.378610013],[43.613824583,-79.378737945],[43.613799669,-79.37884127],[43.613774826,-79.378993767],[43.613760726,-79.379175754],[43.613757347,-79.379357719],[43.613743225,-79.379520032],[43.613736203,-79.379628239],[43.613725546,-79.379697118],[43.613700608,-79.379761095],[43.613611416,-79.379894055],[43.613540051,-79.379987633],[43.613454433,-79.380120572],[43.613408078,-79.380209183],[43.613351007,-79.380302731],[43.613265399,-79.380445519],[43.613222579,-79.380489855],[43.613197606,-79.380539088],[43.613183395,-79.380617798],[43.613172741,-79.380681746],[43.61315138,-79.380750645],[43.613133584,-79.380819525],[43.613105052,-79.38087367],[43.613047949,-79.38093772],[43.61290947,-79.381087596],[43.612777258,-79.381281328],[43.612740323,-79.381366325],[43.612687954,-79.381447101],[43.612598565,-79.381532199],[43.612533828,-79.381587528],[43.612478346,-79.381642839],[43.612466062,-79.381698068],[43.612444542,-79.381770298],[43.612379863,-79.381880819],[43.612296685,-79.381999873],[43.612256639,-79.382063653],[43.612239626,-79.382124898],[43.612225365,-79.382182955],[43.612325154,-79.382230262],[43.612283013,-79.382288421],[43.612252446,-79.382404637],[43.612241231,-79.382673902],[43.612241356,-79.382795324],[43.612226119,-79.382911498],[43.612210896,-79.383032948],[43.612134498,-79.383339305],[43.612111606,-79.38346077],[43.612096366,-79.383566388],
                [43.612096474,-79.383671977],[43.612096577,-79.383772275],[43.612092785,-79.383814504],[43.612054525,-79.383899067],[43.612012443,-79.38401529],[43.61200493,-79.384168403],[43.612016575,-79.384316203],[43.612009089,-79.384495717],[43.611990115,-79.38470164],[43.611971039,-79.384807264],[43.61196346,-79.384897022],[43.611978961,-79.385039538],[43.611998413,-79.385324589],[43.612013009,-79.38557085],[43.612007499,-79.385748674],[43.612010133,-79.385925096],[43.612015195,-79.386054003],[43.612030158,-79.386226996],[43.612062461,-79.386484782],[43.612079866,-79.386634034],[43.612097303,-79.386807021],[43.612107349,-79.386996996],[43.612107627,-79.387278577],[43.612122681,-79.387546579],[43.612117858,-79.387658544],[43.612115624,-79.387885855],[43.61211575,-79.388014759],[43.612115794,-79.388069059],[43.612103523,-79.388113184],[43.612078921,-79.388177687],[43.612051847,-79.388218445],[43.611998058,-79.388251943],[43.611992352,-79.388308508],[43.611986252,-79.388348645],[43.611997011,-79.388369748],[43.612012374,-79.3883845],[43.612030821,-79.388414038],[43.61203546,-79.388454157],[43.612038569,-79.388494279],[43.612027857,-79.388521763],[43.61201252,-79.388534452],[43.612001819,-79.388564043],[43.612001843,-79.388597839],[43.612006466,-79.38862106],[43.61200648,-79.388635839],[43.612006496,-79.388652738],[43.612003441,-79.388667522],[43.611995789,-79.388675985],[43.611983513,-79.388688681],[43.611963574,-79.388697166],[43.611958978,-79.388709847],[43.611954409,-79.388733085],[43.611954437,-79.388771105],[43.611955998,-79.38880278],[43.61196219,-79.388857675],[43.611976107,-79.388959026],[43.611999215,-79.38905403],[43.612022307,-79.389130017],[43.612049972,-79.389178544],[43.612057681,-79.389210208],[43.612062317,-79.38924822],[43.612070019,-79.389271435],[43.612079243,-79.389296765],[43.612091547,-79.389324196],[43.612094629,-79.389336865],[43.612099258,-79.389357966],[43.612114624,-79.389385405],[43.612129995,-79.389408606],[43.612140768,-79.389433934],[43.612151523,-79.3894508],[43.612154619,-79.38947826],[43.612166941,-79.38951414],[43.61217923,-79.389543678],[43.612197683,-79.38957956],[43.612243776,-79.389677731],[43.61230085,-79.389763941],[43.612399351,-79.389851416],[43.612468827,-79.389859258],[43.612549879,-79.389859114],[43.612601937,-79.389803246],[43.612636534,-79.389675704],[43.612694426,-79.389675602],[43.612752347,-79.389707374],[43.61283915,-79.389667377],[43.612879653,-79.389643407],[43.612966455,-79.389611375],[43.613041719,-79.38961124],[43.613128607,-79.389658894],[43.613192339,-79.389714554],[43.613238737,-79.389810077],[43.61326193,-79.389841899],[43.613296722,-79.389897612],[43.613406723,-79.389905382],[43.61356882,-79.389905093],[43.613655683,-79.389936815],[43.613777392,-79.390072047],[43.613916464,-79.390215214],[43.613991828,-79.390318653],[43.614015051,-79.390382353],[43.614061433,-79.390461944],[43.614212114,-79.390621026],[43.614362738,-79.390748243],[43.614414886,-79.390795948],[43.614507569,-79.39085156],[43.614594539,-79.390986857],[43.614687297,-79.391122144],[43.614809034,-79.391297211],[43.614913375,-79.391440445],[43.614994517,-79.391543888],[43.61505865,-79.391614159],[43.615094349,-79.391640064],[43.615134302,-79.391651776],[43.615177101,-79.391655629],[43.615217038,-79.391651631],[43.615294035,-79.391616162],[43.615479415,-79.391560865],[43.615650576,-79.391548782],[43.615853149,-79.391560209],[43.616001522,-79.391591356],[43.616107101,-79.391614735],[43.616204154,-79.39166561],[43.616392557,-79.391790921],[43.61651816,-79.391865298],[43.61665098,-79.391919368],[43.616924846,-79.392118448],[43.617230301,-79.392339628],[43.61755271,-79.392584134],[43.617875137,-79.392840302],[43.61827398,-79.393201381],[43.618469139,-79.393364416],[43.618553982,-79.393422613],[43.618706614,-79.393434021],[43.618935769,-79.393690371],[43.619198778,-79.393864964],[43.619478833,-79.39414456],[43.619758885,-79.394424158],[43.619860667,-79.394470658],[43.620166251,-79.394855247],[43.62036997,-79.395111651],[43.620446362,-79.395204881],[43.620539715,-79.395298083],[43.620734901,-79.395496144],[43.621023529,-79.395892443],[43.621244233,-79.396183827],[43.621422466,-79.396393594],[43.621668657,-79.396731612],[43.621946261,-79.397128831],[43.622290672,-79.39761046],[43.622575567,-79.39801516],[43.622703226,-79.3981365],[43.622860321,-79.398257792],[43.623095957,-79.398432979],[43.623184333,-79.398513868],[43.623420058,-79.398797104],[43.623665606,-79.399093821],[43.623812965,-79.399309687],[43.62389155,-79.399417607],[43.624029074,-79.399606466],
                [43.624215634,-79.399768235],[43.624333478,-79.399889597],[43.624490636,-79.400091935],[43.6246871,-79.400375246],[43.624942511,-79.400739502],[43.625394383,-79.40136007],[43.625600707,-79.401670379],[43.625767759,-79.401953752],[43.626033011,-79.402331517],[43.626376897,-79.402871239],[43.626637975,-79.403291494],[43.62665619,-79.403349755],[43.62656381,-79.403747829],[43.626528501,-79.403924314],[43.626441081,-79.404286652],[43.627154789,-79.404633676],[43.627280154,-79.404694633],[43.627433248,-79.404762537],[43.627527789,-79.404799564],[43.627640344,-79.404838509],[43.627743902,-79.40488442],[43.627838434,-79.404899378],[43.627910394,-79.404822984],[43.627977796,-79.404700897],[43.628058723,-79.404592729],[43.628144148,-79.404472943],[43.628243074,-79.404371723],[43.628323974,-79.404232589],[43.628404883,-79.404105051],[43.628490297,-79.403981386],[43.628580204,-79.403851912],[43.628670136,-79.403751088],[43.628751049,-79.403630525],[43.62882297,-79.403520434],[43.628894897,-79.403417704],[43.628980319,-79.403307976],[43.629074753,-79.403208309],[43.629155666,-79.403088525],[43.629223074,-79.402965652],[43.629281509,-79.402877267],[43.629344453,-79.402798169],[43.629398368,-79.402687336],[43.629411843,-79.402656335],[43.629452309,-79.402598177],[43.630121913,-79.401414065],[43.630449969,-79.400796654],[43.631551416,-79.398765535],[43.632677876,-79.397854072],[43.633419517,-79.397282474],[43.6339515,-79.396872399],[43.634307203,-79.397200662],[43.634330228,-79.397219597],[43.634464026,-79.397329605],[43.635236372,-79.397979391],[43.635429492,-79.398141864],[43.635566802,-79.39826074],[43.635644082,-79.39833781],[43.635674999,-79.398365541],[43.635714458,-79.398403765],[43.635778142,-79.398476745],[43.635858302,-79.398594609],[43.635923424,-79.398697144],[43.63597451,-79.39878326],[43.636009349,-79.398850245],[43.636054835,-79.398936248],[43.636259821,-79.399368864],[43.636302055,-79.399440401],[43.636339404,-79.399494732],[43.636404206,-79.399577522],[43.636434379,-79.399609397],[43.636480634,-79.399646437],[43.636484723,-79.399649677],[43.636631562,-79.399720931],[43.636826327,-79.399815417],[43.637341638,-79.400017955],[43.637371516,-79.400030895],[43.637856167,-79.400240642],[43.637959932,-79.400286787],[43.638024735,-79.40030951],[43.638108419,-79.400346132],[43.638312948,-79.40043564],[43.638839472,-79.400649566],[43.638872213,-79.400662874],[43.640369745,-79.401271355],[43.640555846,-79.401348137],[43.640749794,-79.401421992],[43.641388289,-79.4016813],[43.641523062,-79.401736041],[43.641915264,-79.40189534],[43.642655357,-79.402195895],[43.643194069,-79.402396713],[43.643926314,-79.402705536],[43.644412234,-79.402900731],[43.644541903,-79.402955581],[43.644890431,-79.403105569],[43.645192006,-79.403233734],[43.645516583,-79.403369648],[43.646471749,-79.403760948],[43.646849786,-79.403898929],[43.647188293,-79.404010501],[43.647613316,-79.402001823],[43.64770959,-79.401413718],[43.647813486,-79.400937869],[43.647887907,-79.40059705],[43.647975897,-79.400146263],[43.648067555,-79.399676685],[43.648325817,-79.398418609],[43.648373692,-79.398178015],[43.64853801,-79.397414941],[43.648765518,-79.396381621],[43.649351162,-79.393702301],[43.649406485,-79.393448608],[43.64968115,-79.392155985],[43.649897752,-79.391137096],[43.649988827,-79.390706642],[43.650030102,-79.390504409],[43.650073702,-79.390290617],[43.650081767,-79.390255334],[43.650195953,-79.389755366],[43.650232023,-79.389476678],[43.650421281,-79.388643292],[43.650672917,-79.38751633],[43.650585917,-79.387430793],[43.650258464,-79.387289569],[43.649906415,-79.387137745],[43.649254649,-79.386881144],[43.648638247,-79.386621335],[43.648009317,-79.386369458],[43.647395085,-79.386110583],[43.646053987,-79.38556188],[43.64477561,-79.385021503],[43.644965089,-79.38403993],[43.644974176,-79.383992872],[43.64508345,-79.383426707],[43.645278316,-79.382534885],[43.645292254,-79.382471069],[43.645987057,-79.379134973],[43.646101506,-79.378469303],[43.646182895,-79.378183732],[43.646229419,-79.37803352],[43.646283881,-79.377922922],[43.646297807,-79.377892509],[43.646342278,-79.377789233],[43.646420929,-79.377655849],[43.646469926,-79.377542943],[43.646748829,-79.377102292],[43.646810477,-79.377024464],[43.646884793,-79.376974315]]]])]})
        })));

        tick();

        expect(result.id).toEqual(77, ' should return id 77');
        expect(result.name).toEqual("Waterfront Communities-The Island", ' should return a matching name');
    }));
})